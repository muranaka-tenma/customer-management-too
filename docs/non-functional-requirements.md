# 非機能要件定義書
## 顧客管理ツール（BtoB CRM）

**文書バージョン**: 1.0  
**作成日**: 2025-01-27  
**最終更新**: 2025-01-27  

---

## 1. システム概要

本文書は、BtoB営業活動支援CRMシステムの非機能要件を定義します。システムの品質特性、パフォーマンス、セキュリティ、運用性について規定します。

---

## 2. パフォーマンス要件

### 2.1 応答時間要件

#### 2.1.1 Web UIレスポンス時間
- **NFR-001**: ページ初期表示時間 ≤ 3秒（通常接続環境）
- **NFR-002**: ページ遷移時間 ≤ 1秒
- **NFR-003**: 検索結果表示 ≤ 2秒（1000件まで）
- **NFR-004**: フィルタ適用 ≤ 1秒

#### 2.1.2 API応答時間
- **NFR-005**: 認証API ≤ 500ms
- **NFR-006**: CRUD操作API ≤ 1秒
- **NFR-007**: 検索API ≤ 2秒
- **NFR-008**: Gmail同期API ≤ 10秒（初回同期除く）
- **NFR-009**: データエクスポートAPI ≤ 30秒（10万件まで）

#### 2.1.3 Gmail連携パフォーマンス
- **NFR-010**: 新着メール取得 ≤ 5秒
- **NFR-011**: 初回全件同期 ≤ 10分（10万件）
- **NFR-012**: 差分同期 ≤ 30秒

### 2.2 スループット要件

#### 2.2.1 同時ユーザー数
- **NFR-013**: 同時アクティブユーザー数 100名以上対応
- **NFR-014**: 同時API呼び出し 1000req/分以上対応

#### 2.2.2 データ処理能力
- **NFR-015**: 顧客データ登録 1000件/分
- **NFR-016**: メール同期処理 100件/分
- **NFR-017**: 一括インポート 10万件/30分

---

## 3. 可用性・信頼性要件

### 3.1 サービス可用性
- **NFR-018**: システム稼働率 99.5%以上（月次）
- **NFR-019**: 計画メンテナンス時間 月4時間以内
- **NFR-020**: 緊急メンテナンス時間 月2時間以内

### 3.2 障害対応
- **NFR-021**: システム障害検知時間 ≤ 5分
- **NFR-022**: 障害復旧時間 ≤ 30分（軽微な障害）
- **NFR-023**: 障害復旧時間 ≤ 2時間（重大な障害）
- **NFR-024**: データ整合性保証（ACID特性遵守）

### 3.3 データ保護
- **NFR-025**: データバックアップ 日次自動実行
- **NFR-026**: バックアップ保存期間 90日間
- **NFR-027**: バックアップデータ復旧時間 ≤ 4時間
- **NFR-028**: データ損失許容時間 ≤ 24時間（RPO）

---

## 4. セキュリティ要件

### 4.1 認証・認可
- **NFR-029**: 多要素認証サポート（Google OAuth2）
- **NFR-030**: パスワード強度チェック（最低8文字、英数記号組み合わせ）
- **NFR-031**: セッション管理（24時間自動タイムアウト）
- **NFR-032**: JWT トークン有効期限管理（アクセストークン1時間、リフレッシュトークン7日）

### 4.2 データ暗号化
- **NFR-033**: 通信暗号化（TLS 1.3以上）
- **NFR-034**: データベース機密情報暗号化（AES-256）
- **NFR-035**: APIトークン暗号化保存
- **NFR-036**: ログファイル機密情報マスキング

### 4.3 アクセス制御
- **NFR-037**: ロールベースアクセス制御（RBAC）実装
- **NFR-038**: データレベルアクセス制御（行レベルセキュリティ）
- **NFR-039**: API呼び出し頻度制限（Rate Limiting）
- **NFR-040**: 不正アクセス検知・ブロック機能

### 4.4 プライバシー保護
- **NFR-041**: 個人情報匿名化機能
- **NFR-042**: データ削除要求対応（GDPR対応）
- **NFR-043**: データ処理記録（監査ログ）
- **NFR-044**: クッキー使用同意機能

---

## 5. 使いやすさ（ユーザビリティ）要件

### 5.1 操作性
- **NFR-045**: 直感的なユーザーインターフェース
- **NFR-046**: キーボードショートカット対応
- **NFR-047**: ドラッグ&ドロップ操作対応
- **NFR-048**: 操作取り消し機能（Undo/Redo）

### 5.2 レスポンシブデザイン
- **NFR-049**: マルチデバイス対応（PC、タブレット、スマートフォン）
- **NFR-050**: ブラウザ対応（Chrome、Firefox、Safari、Edge最新3バージョン）
- **NFR-051**: 画面解像度対応（1024×768以上）

### 5.3 アクセシビリティ
- **NFR-052**: WCAG 2.1 AA準拠
- **NFR-053**: スクリーンリーダー対応
- **NFR-054**: カラーコントラスト比 4.5:1以上
- **NFR-055**: フォントサイズ調整機能

### 5.4 ユーザーサポート
- **NFR-056**: オンラインヘルプ機能
- **NFR-057**: ツールチップ・ガイド機能
- **NFR-058**: 操作チュートリアル
- **NFR-059**: エラーメッセージの日本語化・明確化

---

## 6. 拡張性・保守性要件

### 6.1 スケーラビリティ
- **NFR-060**: ユーザー数10倍増加に対応可能なアーキテクチャ
- **NFR-061**: データ量100倍増加に対応可能なDB設計
- **NFR-062**: ロードバランシング対応
- **NFR-063**: マイクロサービス化対応準備

### 6.2 開発・運用効率
- **NFR-064**: 自動化されたCI/CDパイプライン
- **NFR-065**: 自動テスト実行（単体・結合・E2Eテスト）
- **NFR-066**: コードカバレッジ 80%以上
- **NFR-067**: 静的コード解析実行

### 6.3 監視・ログ
- **NFR-068**: アプリケーション監視（APM）
- **NFR-069**: リアルタイムアラート機能
- **NFR-070**: 構造化ログ出力
- **NFR-071**: ログ集約・分析機能

### 6.4 メンテナンス性
- **NFR-072**: データベースマイグレーション自動化
- **NFR-073**: ゼロダウンタイムデプロイメント
- **NFR-074**: 設定外部化（環境変数管理）
- **NFR-075**: コンテナ化対応（Docker）

---

## 7. 外部システム連携要件

### 7.1 Gmail API連携
- **NFR-076**: Gmail API利用制限内での動作（1日10億クエリ）
- **NFR-077**: APIエラー時の自動リトライ機能
- **NFR-078**: レート制限対応（Exponential Backoff）
- **NFR-079**: OAuth2認証フロー適切な実装

### 7.2 AI・機械学習連携
- **NFR-080**: 外部AI APIレスポンス時間 ≤ 10秒
- **NFR-081**: AI分析結果信頼度表示
- **NFR-082**: AI機能のオン/オフ切り替え
- **NFR-083**: AI学習データプライバシー保護

---

## 8. 運用要件

### 8.1 デプロイメント
- **NFR-084**: 本番環境デプロイ時間 ≤ 30分
- **NFR-085**: ロールバック時間 ≤ 10分
- **NFR-086**: Blue-Greenデプロイメント対応
- **NFR-087**: カナリアリリース対応

### 8.2 データ管理
- **NFR-088**: データ保持期間ポリシー遵守
- **NFR-089**: 定期的なデータクリーンアップ
- **NFR-090**: データアーカイブ機能
- **NFR-091**: 災害復旧計画（BCP）策定

### 8.3 コンプライアンス
- **NFR-092**: 個人情報保護法遵守
- **NFR-093**: セキュリティ監査対応
- **NFR-094**: 利用ログの法的保存期間遵守
- **NFR-095**: 第三者セキュリティ診断実施

---

## 9. リソース要件

### 9.1 サーバーリソース（初期構成）
- **NFR-096**: WebサーバーCPU: 4vCPU、メモリ: 8GB
- **NFR-097**: DBサーバーCPU: 8vCPU、メモリ: 16GB
- **NFR-098**: ストレージ: 500GB（データ）+ 200GB（ログ・バックアップ）

### 9.2 ネットワーク要件
- **NFR-099**: インターネット接続帯域 100Mbps以上
- **NFR-100**: CDN利用による静的コンテンツ配信高速化

---

## 10. 品質要件の優先度

### 10.1 必須要件（Phase 1）
- 基本的なパフォーマンス要件（NFR-001〜012）
- セキュリティ要件（NFR-029〜044）
- 基本的な可用性要件（NFR-018〜028）

### 10.2 重要要件（Phase 2）
- 使いやすさ要件（NFR-045〜059）
- 外部システム連携要件（NFR-076〜083）
- 基本的な運用要件（NFR-084〜091）

### 10.3 拡張要件（Phase 3）
- 高度な拡張性要件（NFR-060〜075）
- コンプライアンス要件（NFR-092〜095）
- リソース最適化要件（NFR-096〜100）

---

## 11. 非機能要件の測定方法

### 11.1 パフォーマンステスト
- 負荷テスト（想定ユーザー数での動作確認）
- ストレステスト（限界値での動作確認）
- スパイクテスト（急激な負荷増加への対応確認）

### 11.2 セキュリティテスト
- 脆弱性診断（OWASP Top 10対応確認）
- ペネトレーションテスト
- 認証・認可テスト

### 11.3 ユーザビリティテスト
- ユーザー受入テスト
- アクセシビリティテスト
- クロスブラウザテスト

---

**文書終了**